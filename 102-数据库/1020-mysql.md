### 概念

#### 数据库索引了解吗？

```Java
一般谈到底层数据结构
        常见的 mysql 主要有两种结构：Hash索引和 B+ Tree索引以及Full-text索引，我们使用的是 innoDB 引擎，
        默认是 B+ 树。

        两种结构的区别：
        Hash索引底层是哈希表，哈希表是一种以 key-value 形式存储数据的机构，所以多个数据在存储关系上是完全没有
        任何顺序关系的，所以对于区间查询是无法直接通过索引查询的，就需要全表扫描，哈希表只适用于等值查询的场景。
        B+ Tree 是一种多路平衡查询树，所以它的节点是天然有序的，对于范围查询的时候是不需要做全表扫描的。

```

#### 索引都有哪些分类？

```Java
按数据结构分类：
        B+ Tree 索引
        Hash 索引
        Full-Text 索引
        按物理存储分类：
        聚蔟索引
        二级索引（辅助索引）
        按字段特性分类：
        主键索引
        普通索引
        前缀索引
        按字段个数分类：
        单列索引
        联合索引（复合索引、组合索引）

```

#### 性别和时间可以做索引吗？

```text
性别：不建议做索引
  值重复率高的字段不适合建索引。例如**性别、status、值少的字典**
  访问索引需要付出额外的IO开销，你从索引中拿到的只是地址，要想真正访问到数据还是要对表进行一次IO。
    假如你要从表的100万行数据中取几个数据，那么利用索引迅速定位，访问索引的这IO开销就非常值了。
    但如果你是从100万行数据中取50万行数据，就比如性别字段，那你相对需要访问50万次索引，再访问50万次表，加起来的开销并不会比直接对表进行一次完整扫描小。
时间：可以
  时间列适合使用聚集索引，因为时间列重复值极少且经常用于排序及范围过滤。

```

参考资料：

#### 解释 MySQL 外连接、内连接与自连接的区别

```text
交叉连接定义: 
  交叉连接又叫笛卡尔积，它是指不使用任何条件，直接将一个表的所有记录和另一个表中的所有记录一一匹配。

1. 内连接 
  则是只有条件的交叉连接，根据某个条件筛选出符合条件的记录，
  不符合条件的记录不会出现在结果集中，即内连接只连接匹配的行。
2. 外连接 
  其结果集中不仅包含符合连接条件的行，而且还会包括左表、右表或两个表中
  的所有数据行，这三种情况依次称之为左外连接，右外连接，和全外连接。

  左外连接
    也称左连接，左表为主表，左表中的所有记录都会出现在结果集中，
    对于那些在右表中并没有匹配的记录，仍然要显示，右边对应的那些字段值以NULL 来填充。
  右外连接
    也称右连接，右表为主表，右表中的所有记录都会出现在结果集中。
    左连接和右连接可以互换，MySQL 目前还不支持全外连接。
```

#### MySQL 中有哪几种锁？

```text
1、表级锁：开销小，加锁快；不会出现死锁；锁定粒度大，发生锁冲突的概率最高，并发度最低。
2、行级锁：开销大，加锁慢；会出现死锁；锁定粒度最小，发生锁冲突的概率最低，并发度也最高。
3、页面锁：开销和加锁时间界于表锁和行锁之间；会出现死锁；锁定粒度界于表锁和行锁之间，并发度一般。
```

#### MySQL 中有哪些不同的表格？

```text
共有 5 种类型的表格：
1、MyISAM
2、Heap
3、Merge
4、INNODB
5、ISAM
```

#### 简述在 MySQL 数据库中 MyISAM 和 InnoDB 的区别？

```text
MyISAM：
1. 不支持事务，但是每次查询都是原子的；
2. 支持表级锁，即每次操作是对整个表加锁；
3. 存储表的总行数；
一个 MYISAM 表有三个文件：索引文件、表结构文件、数据文件；采用菲聚集索引，
  索引文件的数据域存储指向数据文件的指针。辅索引与主索引基本一致，但是辅索引不用保证唯一性。

InnoDb：
1. 支持 ACID 的事务，支持事务的四种隔离级别；
2. 支持行级锁及外键约束：因此可以支持写并发；
3. 不存储总行数：
一个 InnoDb 引擎存储在一个文件空间（共享表空间，表大小不受操作系统控制，
  一个表可能分布在多个文件里），也有可能为多个（设置为独立表空，表大小受操作系统文件大小限制，一般为 2G）
  ，受操作系统文件大小的限制；主键索引采用聚集索引（索引的数据域存储数据文件本身）
  ，辅索引的数据域存储主键的值；因此从辅索引查找数据，需要先通过辅索引找到主键值，再访问辅索引；
  最好使用自增主键，防止插入数据时，为维持 B+树结构，文件的大调整。
```

#### MySQL 中 InnoDB 支持的四种事务隔离级别名称，以及逐级之间的区别？

```text
SQL 标准定义的四个隔离级别为：
1、read uncommited ：读到未提交数据
2、read committed：脏读，不可重复读
3、repeatable read：可重读
4、serializable ：串行事物
```



#### CHAR 和 VARCHAR 的区别？

```text
1、CHAR 和 VARCHAR 类型在存储和检索方面有所不同
2、CHAR 列长度固定为创建表时声明的长度，长度值范围是 1 到 255 当 CHAR
值被存储时，它们被用空格填充到特定长度，检索 CHAR 值时需删除尾随空格。
```

#### 在 MySQL 中 ENUM 的用法是什么？

```Java
ENUM 是一个字符串对象，用于指定一组预定义的值，并可在创建表时使用。
        SQL 语法如下：
        Create table size(name ENUM('Smail,'Medium','Large');
```

#### 主键和候选键有什么区别？

```text
表格的每一行都由主键唯一标识,一个表只有一个主键。
主键也是候选键。按照惯例，候选键可以被指定为主键，并且可以用于任何外键
引用。
```



#### myisamchk 是用来做什么的？

```text
它用来压缩 MyISAM 表，这减少了磁盘或内存使用
```



#### MyISAM Static 和 MyISAM Dynamic 有什么区别？

```text
在 MyISAM Static 上的所有字段有固定宽度。
动态 MyISAM 表将具有像 TEXT，BLOB 等字段，以适应不同长度的数据类型。
MyISAM Static 在受损情况下更容易恢复。
```



### 具体使用

#### 如果一个表有一列定义为 TIMESTAMP，将发生什么？

```text
每当行被更改时，时间戳字段将获取当前时间戳。
```



#### 列设置为 AUTO INCREMENT 时，如果在表中达到最大值，会发生什么情况？

```text
它会停止递增，任何进一步的插入都将产生错误，因为密钥已被使用。
```



#### 怎样才能找出最后一次插入时分配了哪个自动增量？

```text
LAST_INSERT_ID 将返回由 Auto_increment 分配的最后一个值，并且不需要指定表名称。
```



#### LIKE 声明中的％和_是什么意思？

```text
％对应于 0 个或更多字符，_只是 LIKE 语句中的一个字符。
```



#### 如何在 Unix 和 MySQL 时间戳之间进行转换？

```text
UNIX_TIMESTAMP 是从 MySQL 时间戳转换为 Unix 时间戳的命令
FROM_UNIXTIME 是从 Unix 时间戳转换为 MySQL 时间戳的命令
```



#### BLOB 和 TEXT 有什么区别？

```text
BLOB 是一个二进制对象，可以容纳可变数量的数据。TEXT 是一个不区分大小写
的 BLOB。
BLOB 和 TEXT 类型之间的唯一区别在于对 BLOB 值进行排序和比较时区分大小
写，对 TEXT 值不区分大小写。
```



#### MySQL_fetch_array 和 MySQL_fetch_object 的区别是什么？

```text
以下是 MySQL_fetch_array 和 MySQL_fetch_object 的区别：
MySQL_fetch_array（） – 将结果行作为关联数组或来自数据库的常规数组返回。
MySQL_fetch_object – 从数据库返回结果行作为对象。
```

#### 可以使用多少列创建索引？

```text
任何标准表最多可以创建 16 个索引列。
```



#### MySQL 支持事务吗？

```text
在缺省模式下，MySQL 是 autocommit 模式的，所有的数据库更新操作都会即时
提交，所以在缺省情况下，MySQL 是不支持事务的。

但是如果你的 MySQL 表类型是使用 InnoDB Tables 或 BDB tables 的话，你的
MySQL 就可以使用事务处理,使用 SET AUTOCOMMIT=0 就可以使 MySQL 允许在非 autocommit 模式，在非
autocommit 模式下，你必须使用 COMMIT 来提交你的更改，或者用 ROLLBACK 来回滚你的更改。
```

#### 一张表，里面有ID自增主键，当insert了17条记录之后，删除了第15,16,17条记录，再把Mysql重启，再insert一条记录，这条记录的ID是18还是15 ？

```text
1. 如果表的类型是MyISMA，那么就是 18
    因为MYISAM表会把自增主键的最大ID记录到数据文件里，重启mysql自增主键的最大ID也不会变
2. 如果表的类型是 InnoDB，那么就是 15
    因为 InnoDB 表只是把自增主键的最大ID记录到内存中，
    重启数据库后或者是对表进行 OPTIMIZE 操作，都会导致最大ID丢失。
```



### 底层原理

#### MyISAM 表格将在哪里存储，并且还提供其存储格式？

```text
每个 MyISAM 表格以三种格式存储在磁盘上：
·“.frm”文件存储表定义
·数据文件具有“.MYD”（MYData）扩展名
索引文件具有“.MYI”（MYIndex）扩展名
```



### 性能分析

#### MySQL 数据库服务器性能分析的方法命令有哪些?

```Java
Show status;  查看一些值得监控的变量值
        Bytes_received和Bytes_sent 和服务器之间来往的流量。
        Com_*服务器正在执行的命令。
        Created_*在查询执行期限间创建的临时表和文件。
        Handler_*存储引擎操作。
        Select_*不同类型的联接执行计划。
        Sort_*几种排序信息。
        Show profiles 分析当前会话SQL语句执行的资源消耗情况

```



### 发表地址

```text
https://github.com/yltrcc/interview
git clone:
    https: https://github.com/yltrcc/interview.git
```
